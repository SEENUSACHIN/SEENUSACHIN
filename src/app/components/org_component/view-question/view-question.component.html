<app-org-nav></app-org-nav>
<div
  class="modal fade"
  id="addQuestion"
  data-bs-backdrop="static"
  data-bs-keyboard="false"
  tabindex="-1"
  aria-labelledby="staticBackdropLabel"
  aria-hidden="true"
>
  <div
    class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg"
  >
    <div class="modal-content">
      <div class="modal-header py-1 align-items-center">
        <h5 class="modal-title" id="staticBackdropLabel">
          {{ "Add Question" }}
        </h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
          #closebutton
        ></button>
      </div>
      <div class="modal-body modelHeight">
        <form>
          <div>
            <div class="col-md-12 mt-3 row">
              <div class="col-md-12 form-group">
                <div class="input-group">
                  <input
                  class="col-md-11 form-control"
                  name="search"
                  id="search"
                  [(ngModel)]="searchString"
                  placeholder="Search question..."
                  type="text"
                  />
                  <div class="col-md-1 input-group-btn">
                    <button class="btn btn-success" (click)="getAllQuestion()" type="button">
                      <i class="bi bi-search"></i>
                    </button>
                  </div>
                </div>
              </div>
              <div *ngIf="questionList.length != 0 && searchString != null" class="col-md-12 form-group mt-2">
                <div class="input-group">
                  <ng-select
                  class="col-md-11 custom"
                  [items]="questionList"
                  bindLabel="name"
                  bindValue="id"
                  placeholder="Select Question"
                  [multiple]="false"
                  [closeOnSelect]="true"
                  (change)="onSelect($event)"
                  dropdownPosition="auto"
                  >
                  </ng-select>

                  <div class="input-group-btn col-md-1">
                    <button class="btn btn-success" (click)="addQuestion()">
                      <!-- Add -->
                      <i class="bi bi-plus-lg"></i>
                    </button>
                  </div>
                </div>
              </div>
              <div class="mt-2" style="text-align: center;" *ngIf="questionList.length == 0 && searchString != null">
                Question not found
              </div>
              <div
                class="col-md-12 mt-3 form-group"
                *ngIf="selectedQues != null"
              >
                <div class="canName">
                  <div *ngIf="selectedQues.type == 'image/png'">
                    <a target="_blank" [href]="selectedQues.url"
                      ><img [src]="selectedQues.url" width="300" height="150"
                    /></a>
                  </div>
                  <div class="col-md-12 mt-3 row">
                    <div class="col-md-8">
                      <div>
                        <b>Options </b>
                        <div
                          class="ansClass"
                          *ngFor="let opt of selectedQues.option"
                        >
                          <input
                            type="radio"
                            [checked]="opt.answer === true"
                            id="{{ opt.id }}"
                            name="{{ opt.id }}"
                            value="{{ opt.id }}"
                          />
                          <label for="{{ opt.id }}">
                            {{ opt.name }}
                            <div *ngIf="opt.type == 'image/png'">
                              <a target="_blank" [href]="opt.url"
                                ><img [src]="opt.url" width="250" height="110"
                              /></a>
                            </div>
                            <div *ngIf="opt.type == 'video/mp4'">
                              <video width="250" height="110" controls>
                                <source [src]="opt.url" type="video/mp4" />
                              </video>
                            </div> </label
                          ><br />
                        </div>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div>
                        <b>Level </b>
                        <div class="level">
                          {{ selectedQues.level }}
                        </div>
                      </div>
                      <div class="mt-3">
                        <b>Score </b>
                        <div class="level">
                          {{ selectedQues.score }}
                        </div>
                      </div>
                      <div class="mt-3">
                        <b>Updated On </b>
                        <div class="level">
                          {{ selectedQues.updated_on | date : "medium" }}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          Close
        </button>
      </div>
    </div>
  </div>
</div>
<div
  class="modal fade"
  id="addNewQuestion"
  data-bs-backdrop="static"
  data-bs-keyboard="false"
  tabindex="-1"
  aria-labelledby="staticBackdropLabel"
  aria-hidden="true"
>
  <app-add-questions (newItemEvent)="loadQues($event)"></app-add-questions>
</div>

<div class="p-2 min-vh-100 orgDasboard">
  <div class="container">
    <div class="mt-1" id="pointer">
      <h5>
        <b class="headerText">{{ sessionName }}</b>
      </h5>
    </div>
    <div class="mt-2">
      <div class="d-flex justify-content-between">
        <h6>
          <b class="headerText">{{ "Questions" }}</b>
        </h6>
        <div ngbDropdown>
          <button class="btn btn-success btn-sm" id="gfg" ngbDropdownToggle>
            Add Questions
          </button>
          <div ngbDropdownMenu="gfg">
            <!-- <button
              ngbDropdownItem
              data-bs-toggle="modal"
              id="crBtn"
              type="button"
              data-bs-target="#addQuestion"
            >
              Add Questions From Repository
            </button> -->
            <button
              ngbDropdownItem
              id="crBtn"
              type="button"
              (click)="addRepositoryQuestion()"
            >
              Add Questions From Repository
            </button>
            <button ngbDropdownItem data-bs-toggle="modal"
            id="crBtn"
            type="button"
            data-bs-target="#addNewQuestion">Add New Question</button>
          </div>
        </div>
        <!-- <button
          class="btn btn-success btn-sm"
          data-bs-toggle="modal"
          id="crBtn"
          type="button"
          data-bs-target="#addQuestion"
          style="padding: 6.5px 12px"
        >
          Add Questions
        </button> -->
      </div>
      <div *ngIf="questionObj.length == 0" style="text-align: center;" class="mt-5">
        No questions has added yet.
      </div>
      <div *ngIf="questionObj.length != 0" class="">
        <div class="card mt-2 quizCard" *ngFor="let item of questionObj">
          <div class="card-body">
            <div class="col-12 row">
              <div class="col-8">
                <div *ngIf="item.question.type == 'image/png'">
                  <a target="_blank" [href]="item.question.url"
                    ><img [src]="item.question.url" width="300" height="150"
                  /></a>
                </div>
                <div *ngIf="item.question.type == 'video/mp4'">
                  <video width="150" height="80" controls>
                    <source [src]="item.question.url" type="video/mp4" />
                  </video>
                </div>
                <p class="quesClass">{{ item.question.name }}</p>
                <div class="ansClass" *ngFor="let opt of item.question.option">
                  <input
                    type="radio"
                    [checked]="opt.answer === true"
                    id="{{ opt.id }}"
                    name="{{ opt.id }}"
                    value="{{ opt.id }}"
                  />
                  <label for="{{ opt.id }}">
                    {{ opt.name }}
                    <div *ngIf="opt.type == 'image/png'">
                      <a target="_blank" [href]="opt.url"
                        ><img [src]="opt.url" width="300" height="150"
                      /></a>
                    </div>
                    <div *ngIf="opt.type == 'video/mp4'">
                      <video width="300" height="150" controls>
                        <source [src]="opt.url" type="video/mp4" />
                      </video>
                    </div> </label
                  ><br />
                </div>
              </div>
              <div class="col-4">
                <div class="canName">
                  <b> Level : </b>
                  <span class="level">{{ item.question.level }}</span>
                </div>
                <div class="canName">
                  <b> Score : </b>
                  <span class="level">{{ item.question.score }}</span>
                </div>
                <div class="canName">
                  <b> Updated On : </b>
                  <span class="level">{{
                    item.question.updated_on | date : "medium"
                  }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
