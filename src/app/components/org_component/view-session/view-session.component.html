<app-org-nav></app-org-nav>
<div
  class="modal fade"
  id="endSession"
  data-bs-backdrop="static"
  data-bs-keyboard="false"
  tabindex="-1"
  aria-labelledby="staticBackdropLabel"
  aria-hidden="true"
>
  <div
    class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal"
  >
    <div class="modal-content">
      <div class="modal-body">
        <div style="font-size: 16px; font-weight: 600;">Are You sure want to end this session?</div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          No
        </button>
        <button
          type="button"
          class="btn btn-success"
          (click)="endSession()"
          data-bs-dismiss="modal"
        >
          Yes
        </button>
      </div>
    </div>
  </div>
</div>
<div class="p-2 min-vh-100 orgDasboard">
  <div class="container">
    <div class="mt-1" id="pointer">
      <h5>
        <b class="headerText">{{ sessionName }}</b>
      </h5>
    </div>
    <div class="mt-2">
      <div>{{ msg }}</div>
      <div *ngIf="!showOverallResultTable && questionObj.length != 0" class="card quizCard">
        <div class="btnTopGrpClass">
          <!-- <button class="btn btn-success btn-sm">Show Result</button> -->
          <button
            class="btn btn-primary btn-sm"
            *ngIf="enableStartSessionButton"
            (click)="startSession()"
          >
            Start Session
          </button>
          <button
          *ngIf="enableEndSessionButton"
            class="btn btn-danger btn-sm"
            data-bs-toggle="modal"
            id="crBtn"
            type="button"
            data-bs-target="#endSession"
          >
            End Session
          </button>
        </div>
        <div class="card-body" *ngIf="quesShow != null">
          <div *ngIf="quesShow.question.type == 'image/png'">
            <a target="_blank" [href]="quesShow.question.url"
              ><img [src]="quesShow.question.url" width="300" height="150"
            /></a>
          </div>
          <div *ngIf="quesShow.question.type == 'video/mp4'">
            <video width="300" height="150" controls>
              <source [src]="quesShow.question.url" type="video/mp4" />
            </video>
          </div>
          <p class="quesClass">{{ quesShow.question.name }}</p>
          <div class="ansClass" *ngFor="let item of quesShow.question.option">
            <input
              type="radio"
              [checked]="item.answer == true"
              id="{{ item.id }}"
              name="age"
              value="{{ item.id }}"
            />
            <label for="{{ item.id }}">
              {{ item.name }}
              <div *ngIf="item.type == 'image/png'">
                <a target="_blank" [href]="item.url"
                  ><img [src]="item.url" width="300" height="150"
                /></a>
              </div>
              <div *ngIf="item.type == 'video/mp4'">
                <video width="300" height="150" controls>
                  <source [src]="item.url" type="video/mp4" />
                </video>
              </div> </label
            ><br />
          </div>
        </div>
        <div *ngIf="enableStartSessionButton" class="">
          <div class="btnGrpClass">
            <button
              [disabled]="quesInd == questionObj.length - 1"
              class="btn btn-sm quesBtn"
              [ngClass]="
                quesInd == questionObj.length - 1
                  ? 'btn-default'
                  : 'btn-success'
              "
              (click)="goToNextQues()"
            >
              Next
            </button>
          </div>
        </div>
        <div *ngIf="!enableStartSessionButton" class="">
          <div class="btnGrpClass">
            <button
              [disabled]="disableShow[quesInd]"
              class="btn btn-sm quesBtn"
              [ngClass]="disableShow[quesInd] ? 'btn-default' : 'btn-success'"
              (click)="showQues(quesInd)"
            >
              Show
            </button>
            <button
              [disabled]="quesInd == questionObj.length - 1"
              class="btn btn-sm quesBtn"
              [ngClass]="
                quesInd == questionObj.length - 1
                  ? 'btn-default'
                  : 'btn-success'
              "
              (click)="goToNextQues()"
            >
              Next
            </button>
          </div>
          <div class="btnGrpClass mt-1">
            <button
              class="btn btn-success btn-sm quesBtn"
              (click)="showResult(quesInd, quesShow.question.id)"
            >
              Result
            </button>
            <button
              class="btn btn-success btn-sm quesBtn"
              (click)="showOverallResult()"
            >
              Overall Result
            </button>
          </div>
        </div>
        <!-- result -->
        <div class="mt-1 container" *ngIf="resultShow[quesInd]">
          <div class="d-flex justify-content-between">
            <div class="quesClass">{{ "Result" }}</div>
            <button
              type="button"
              class="btn-close"
              aria-label="Close"
              (click)="closeResult(quesInd)"
            ></button>
          </div>
          <div class="container">
            <table class="table table-hover table-borderless">
              <thead>
                <tr>
                  <th scope="col">#</th>
                  <th scope="col">Participant Name</th>
                  <th scope="col">Score</th>
                  <th scope="col">Answered Time</th>
                </tr>
              </thead>
              <tbody>
                <tr
                  *ngFor="let ritem of resultData; let ri = index"
                  [attr.data-index]="ri"
                >
                  <th scope="row">{{ ri + 1 }}</th>
                  <td>{{ ritem.participant.name }}</td>
                  <td>
                    <span *ngIf="ritem.correct">{{
                      ritem.question.score
                    }}</span>
                    <span *ngIf="!ritem.correct">0</span>
                  </td>
                  <td>{{ ritem.updated_on | dateAgo }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <!-- overall result -->
        <div class="mt-1 container" *ngIf="overallResultShow">
          <div class="d-flex justify-content-between">
            <div class="quesClass">{{ "Overall Result" }}</div>
            <button
              type="button"
              class="btn-close"
              aria-label="Close"
              (click)="closeOverallResult()"
            ></button>
          </div>
          <div class="container">
            <table class="table table-hover table-borderless">
              <thead>
                <tr>
                  <th scope="col">#</th>
                  <th scope="col">Participant Name</th>
                  <th scope="col">Total Score</th>
                  <!-- <th scope="col">Overall Rank</th> -->
                </tr>
              </thead>
              <tbody>
                <tr
                  *ngFor="let oritem of overallResultData; let ori = index"
                  [attr.data-index]="ori"
                >
                  <th scope="row">{{ ori + 1 }}</th>
                  <td>{{ oritem.participant.name }}</td>
                  <td>{{ oritem.score }}</td>
                  <!-- <td>{{ oritem.updated_on | dateAgo }}</td> -->
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <div *ngIf="showOverallResultTable" class="card quizCard">
        <div class="mt-1 container">
          <div class="d-flex justify-content-between">
            <div class="quesClass">{{ "Overall Result" }}</div>
            <button
              type="button"
              class="btn-close"
              aria-label="Close"
              (click)="closeOverallResult()"
            ></button>
          </div>
          <div class="container">
            <table class="table table-hover table-borderless">
              <thead>
                <tr>
                  <th scope="col">#</th>
                  <th scope="col">Participant Name</th>
                  <th scope="col">Total Score</th>
                </tr>
              </thead>
              <tbody>
                <tr
                  *ngFor="let oritem of overallResultData; let ori = index"
                  [attr.data-index]="ori"
                >
                  <th scope="row">{{ ori + 1 }}</th>
                  <td>{{ oritem.participant.name }}</td>
                  <td>{{ oritem.score }}</td>
                </tr>
              </tbody>
            </table>
          </div>
          <span class="mt-3 container d-flex flex-row" style="text-align: start;">
            Goto &nbsp;<a
            class="nav-link"
            style="font-weight: bold; text-decoration: underline;"
            type="button"
            (click)="goToSignIn()"
          >
            SignIn
          </a>
          </span>
        </div>
      </div>
    </div>
  </div>
</div>
